output = 'libinguma'

sources = [
			'TInguma.cc',
            'TLog.cc',
          ]

lua_src = Glob('lua-5.1/*.c')
          
env_ing = Environment()          
env_lua = Environment()
          
env_ing.Append(CPPPATH=['../libs/lua-5.1/src/'])
env_ing.Append(LIBPATH=['../libs/lua-5.1/src/'])
env_ing.Append(LIBS=['lua'])
# OS X
env_ing.Append(CPPFLAGS=['-fno-common'])
env_ing.Replace(SHLINKFLAGS='-dynamiclib -undefined dynamic_lookup')
env_ing.Replace(SHLIBPREFIX='')
# Change variying in function of running O.S
env_ing.Replace(SHLIBSUFFIX='.dylib')

env_lua.Append(CPPFLAGS=['-O2','-Wall','-DLUA_USE_MACOSX'])

objs_ing = env_ing.SharedObject(sources)
objs_lua = env_lua.SharedObject(lua_src)

env_ing.SharedLibrary(output,[objs_ing,objs_lua])
